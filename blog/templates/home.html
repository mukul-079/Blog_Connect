{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <h3 class="text-white my-5">Home Page</h3>

            <!-- Carousel Section -->
            <div id="postCarousel" class="carousel slide mb-5 bg-light" data-ride="carousel">
                <!-- Carousel Inner -->
                <div class="carousel-inner">
                    {% for post in posts|slice:":5" %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <div class="d-flex align-items-center justify-content-center" style="height: 400px;">
                            <div class="row">
                                <!-- Text Content Block -->
                                <div class="col-md-8 offset-md-2">
                                    <div class="jumbotron jumbotron-fluid jumbo-light">
                                        <div class="container">
                                            <h1 class="display-4 font-weight-bold text-dark">{{ post.title }}</h1>
                                            <div class="post-content">
                                                <p class="lead text-dark">{{ post.desc|truncatechars:200 }}</p>
                                                {% if post.desc|length > 200 %}
                                                <p><a href="#" class="read-more" data-toggle="collapse" data-target="#collapse{{ forloop.counter }}">Read More</a></p>
                                                <div id="collapse{{ forloop.counter }}" class="collapse">
                                                    <p class="text-dark">{{ post.desc }}</p>
                                                </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- Previous and Next Buttons -->
                <a class="carousel-control-prev" href="#postCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon bg-dark" aria-hidden="true"></span>
                </a>
                <a class="carousel-control-next" href="#postCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon bg-dark" aria-hidden="true"></span>
                </a>
            </div>

            <h1>Posts: </h1><br>

            <!-- List of Posts -->
            <div class="post-list">
                {% for post in posts %}
                <div class="jumbotron jumbotron-fluid jumbo-light mb-4">
                    <div class="container">
                        <h4 class="display-4 font-weight-bold">{{ post.title }}</h4>
                        <p class="lead">{{ post.desc }}</p>
                    </div>
                </div>
                <br>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Read More functionality -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    // Toggle Read More content
    $('.read-more').click(function(e) {
        e.preventDefault();
        var target = $(this).data('target');
        $(target).collapse('toggle');
        $(this).text(function(i, text){
            return text === "Read More" ? "Read Less" : "Read More";
        });
    });
});
</script>

{% endblock content %}
